import{v as e,i as D,l as E,A as h,I as w,S as $,d as I,U as O,y as b,M as R,D as L,a as N,b as j,B as S,G as T,c as v,T as U,C as V,e as x,f as H,g as W,h as G,j as q,k as J,r as K,m as k,n as A,o as Q,p as X,q as P,s as Y,t as Z,E as M,u as _,L as ee,Q as te,w as ne,V as B,F as re,x as oe,z as ae,H as se,J as le}from"./vendor.cab88c26.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}};ie();const ce=({mode:n,value:t,setValue:o,theme:a})=>e(D,{defaultLanguage:n,theme:a,options:{minimap:{enabled:!1}},onChange:o,value:t,width:"100%",height:"80vh"}),ue=({options:n})=>{const[t,o]=E(!1),a=h(()=>{o(!t)},[t]);return e(I,null,e(w,{verticalAlign:"top","aria-label":"Metaframe settings",icon:e($,null),onClick:a}),e(de,{isOpen:t,setOpen:o,options:n}))},de=({isOpen:n,setOpen:t,options:o})=>{const[a,s]=O("options",Object.fromEntries(o.filter(i=>i.default).map(i=>[i.name,i.default]))),[r,l]=E(a||{}),[g,m]=E(void 0),F=h(i=>{const{name:p,value:u}=i.target;o.find(y=>y.name===p).type==="boolean"?l({...r,[p]:u==="1"}):l({...r,[p]:u})},[r,l]),z=h(()=>{t(!n)},[t,n]),C=h(()=>{const i={};if(Object.keys(r).forEach(u=>{const f=o.find(y=>y.name===u);if(f&&f.validator&&f.type!=="boolean"){const y=f.validator(r[u]);y&&(i[u]=y)}}),Object.keys(i).length>0){m(i);return}m(void 0);const p={};Object.keys(r).forEach(u=>{const f=o.find(y=>y.name===u);f&&f.map?p[u]=f.map(r[u]):p[u]=r[u]}),t(!n),s(p)},[t,n,o,r,s,m]);return b(()=>{const i=p=>{p.key==="Enter"&&n&&C()};return window.addEventListener("keyup",i),()=>{window.removeEventListener("keyup",i)}},[C,n]),e(H,{placement:"top",onClose:C,isOpen:n},e(R,null,e(L,null,e(N,{borderBottomWidth:"0px"},"Configure metaframe (stored in URL hash params )"),e(j,null,e(S,{maxW:"100%",p:2,borderWidth:"4px",borderRadius:"lg",overflow:"hidden"},e(T,{templateColumns:"repeat(12, 1fr)",gap:6},o.map(i=>e(I,null,e(v,{rowSpan:1,colSpan:4},e(S,{w:"100%",h:"100%",display:"flex",alignItems:"center",justifyContent:"flex-end"},e(U,{textAlign:"right",verticalAlign:"bottom"},i.displayName||i.name,":"))),e(v,{rowSpan:1,colSpan:8}," ",me(i,r[i.name],F)))),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:12}),e(v,{rowSpan:1,colSpan:10}),e(v,{rowSpan:1,colSpan:1},e(w,{size:"lg",color:"red",icon:e(V,null),onClick:z})),e(v,{rowSpan:1,colSpan:1},e(w,{size:"lg",color:"green",icon:e(x,null),onClick:C}))))))))},me=(n,t,o)=>{switch(n.type){case"option":return e(q,{name:n.name,value:t,onChange:o,placeholder:"Select option"},n.options.map(a=>e("option",{value:a},a)));case"boolean":return e(G,{name:n.name,rightIcon:e(x,null),onChange:o,isChecked:t===!0||t==="1",value:t?0:1});default:return e(S,{w:"100%",h:"10"},e(W,{name:n.name,type:"text",placeholder:"",value:t,onInput:o}))}};var c;(function(n){n[n.Start=0]="Start",n[n.Editing=1]="Editing",n[n.Running=2]="Running",n[n.Finished=3]="Finished"})(c||(c={}));const d=J(n=>({code:void 0,result:void 0,mode:0,setCode:t=>n(o=>({code:t})),setResult:t=>n(o=>({result:t})),setMode:t=>n(o=>({mode:t}))})),pe=()=>{const n=d(o=>o.mode),t=d(o=>o.result);return c.Running===n?e(K.BeatLoader,{size:8,color:"blue"}):t?t.failure?e(I,null,e(k,{status:"error"},e(A,null),e(X,{mr:2},"Error",t?.failure?.phase?" in phase "+t.failure.phase:"")),e(k,{status:"error"},e(A,null),e(Q,null,`${t.failure?.error}`))):e(k,{status:"success"},e(A,null)):null},fe=Object.getPrototypeOf(async function(){}).constructor,he=(n,t)=>{let o=null,a=Object.keys(t);try{o=fe("exports",`"use strict"; return (async function(${a.join(", ")}){${n}})`)({})}catch(r){return Promise.resolve({failure:{error:r,phase:"compile"}})}if(o){var s="exec";let r=Object.values(t);return o.apply?o.apply(null,r).then(l=>({result:l})).catch(l=>({failure:{error:l,phase:s}})):o.then(l=>l.apply(null,r)).then(l=>({result:l})).catch(l=>({failure:{error:l,phase:s}}))}return Promise.resolve({failure:{error:"compile failed",phase:"compile"}})},ge=()=>{const n=P(),t=d(r=>r.setMode),o=d(r=>r.setResult),a=d(r=>r.result);return b(()=>()=>{if(a?.result&&typeof a?.result=="function")try{a.result()}catch(r){console.error("Failed to cancel without error:",r)}},[a]),[h(async r=>{if(!r||r.trim().length===0){t(c.Finished),o(void 0);return}if(!!n.metaframe){o(void 0);try{const l=await he(r,{metaframe:n.metaframe,chroma:Y,HASHTOOLS:Z});o(l)}catch(l){console.error(l),o({failure:{error:l}})}t(c.Finished)}},[n.metaframe,t,o]),a]},ye=()=>{const n=P(),t=d(g=>g.mode),o=d(g=>g.setMode),a=d(g=>g.code),[s,r]=M("text",void 0),l=h(()=>{switch(t){case c.Editing:s!==a&&r(a),o(c.Running);break;case c.Finished:o(c.Editing);break;case c.Running:o(c.Editing);break;case c.Start:break}},[n.metaframe,a,s,r,t,o]);return e(w,{verticalAlign:"top","aria-label":"Help",colorScheme:t===c.Editing?"blue":void 0,icon:t===c.Editing?e(x,null):e(_,null),size:"md",onClick:l,mr:"4"})},ve=({url:n})=>{const[t,o]=E(!ee());n=n||`${window.location.origin}${window.location.pathname}/README.md`;const a=h(()=>{o(!t)},[t]);return e(I,null,e(w,{verticalAlign:"top","aria-label":"Help",icon:e(te,null),size:"md",onClick:a,mr:"4"}),e(Se,{url:n,isOpen:t,setOpen:o}))},Se=({isOpen:n,setOpen:t,url:o})=>{const a=h(()=>{t(!n)},[t,n]),s=h(()=>{t(!1)},[t]),r=`https://metapages.github.io/metaframe-markdown/#?url=${o}`;return e(H,{size:"full",placement:"top",onClose:a,isOpen:n,onOverlayClick:s},e(R,null,e(L,null,e(ne,{size:"lg",bg:"gray.100"}),e(j,null,e("iframe",{width:"100%",height:"100%",src:r})))))},we=[{name:"theme",displayName:"Light/Dark theme",default:"light",type:"option",options:["light","vs-dark"]}],be=()=>{const[n]=O("options",{theme:"light"}),t=d(m=>m.code),o=d(m=>m.setCode),a=d(m=>m.mode),s=d(m=>m.setMode),[r]=ge(),[l]=M("text",void 0);b(()=>{a===c.Start&&s(c.Running)},[a,s]),b(()=>{a===c.Running&&r&&r(t)},[a,t,r]),b(()=>{o(l),r&&r(l)},[l,o,r]);const g=e(B,{spacing:2,alignItems:"flex-start"},e(re,{width:"100%"},e(ye,null),e(oe,null),e(ve,null),e(ue,{options:we})),e(pe,null));return e(S,{w:"100%",p:2},e(B,{spacing:2,alignItems:"flex-start"},a===c.Editing?e(S,{w:"100%"},e(ce,{mode:"javascript",theme:n?.theme||"light",setValue:o,value:t})):e("div",{id:"render"}),e(S,{w:"30%"},g)))};ae(e(le,null,e(se,null,e(be,null))),document.getElementById("root"));
//# sourceMappingURL=index.daa6a64a.js.map
